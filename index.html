<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8">
<title>rCount Dashboard met hrn.counter</title>
<style>
  body {
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 50px;
  }
  button {
    padding: 10px 20px;
    font-size: 1.2rem;
    cursor: pointer;
  }
  #status, #timing {
    margin-top: 20px;
    font-size: 1rem;
    color: green;
    white-space: pre-line;
  }
</style>
</head>
<body>
<h1>rCount Dashboard</h1>
<button id="btnAdd">Add visit</button>
<div id="status"></div>
<div id="timing"></div>

<script>
// Simulatie van de bibliotheek hrn.counter
// In jouw echte omgeving vervang je dit met de echte lib
window.hrn = window.hrn || {};
hrn.counter = {
  add: function() {
    document.getElementById('status').textContent = "âœ… hrn.counter.add() uitgevoerd!";
    console.log("hrn.counter.add() uitgevoerd!");
  }
};

// Timing UI update
function updateTiming(msg) {
  const div = document.getElementById('timing');
  div.textContent += msg + "\n";
}

// Service Worker registreren met timing
if ('serviceWorker' in navigator) {
  const swStart = performance.now();
  navigator.serviceWorker.register('./sw.js')
    .then(reg => {
      const swRegistered = performance.now();
      updateTiming(`Service Worker registratie duurde ${(swRegistered - swStart).toFixed(2)} ms`);

      // Wachten tot SW klaar is
      navigator.serviceWorker.ready.then(() => {
        const swReady = performance.now();
        updateTiming(`Service Worker is actief en klaar in ${(swReady - swStart).toFixed(2)} ms`);

        // Automatisch +1 via hrn.counter.add()
        hrn.counter.add();
      });
    })
    .catch(e => {
      console.error("SW registratie mislukt:", e);
      updateTiming("SW registratie mislukt: " + e);
    });
}

// Button listener voor handmatig +1
document.getElementById('btnAdd').addEventListener('click', () => {
  hrn.counter.add();
});
</script>
</body>
</html>
